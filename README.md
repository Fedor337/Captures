# –¶–µ–ª—å
–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –∑–æ–Ω–¥—ã —Ä–∞–∑–º–µ—Ä–∞–º–∏ 120–Ω–∫ –∫ —ç–∫–∑–æ–Ω–∞–º –≥–µ–Ω–æ–≤ BRCA1/2 –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–≥–æ –æ–±–æ–≥–∞—â–µ–Ω–∏—è.

# –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å

–¶–µ–ª–µ–≤–æ–µ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ (–∞–Ω–≥–ª. target enrichment) ‚Äî —ç—Ç–æ –º–æ–ª–µ–∫—É–ª—è—Ä–Ω–æ-–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –∏ –æ–±–æ–≥–∞—â–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–∫–æ–≤ –≥–µ–Ω–æ–º–∞ –∏–∑ –æ–±—â–µ–≥–æ –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –≥–µ–Ω–∞—Ö –∏–ª–∏ —Ä–µ–≥–∏–æ–Ω–∞—Ö, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –Ω–µ–Ω—É–∂–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏, –∏ —Ç–µ–º —Å–∞–º—ã–º —ç–∫–æ–Ω–æ–º–∏—Ç —Ä–µ—Å—É—Ä—Å—ã –ø—Ä–∏ —Å–µ–∫–≤–µ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–µ–Ω –ø—Ä–∏ —Å–µ–∫–≤–µ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è (NGS), —Ç–∞–∫ –∫–∞–∫ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö, –ø–æ–≤—ã—à–∞—è –ø—Ä–∏ —ç—Ç–æ–º –≥–ª—É–±–∏–Ω—É –ø–æ–∫—Ä—ã—Ç–∏—è —Ü–µ–ª–µ–≤—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ –∏ —Ç–æ—á–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞.

### –°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Ü–µ–ª–µ–≤–æ–≥–æ –æ–±–æ–≥–∞—â–µ–Ω–∏—è:
#### –ì–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–µ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ:
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–æ—Ç–∏–Ω–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–ª–∏–≥–æ–Ω—É–∫–ª–µ–æ—Ç–∏–¥–Ω—ã–µ –∑–æ–Ω–¥—ã, –∫–æ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–º —Ä–µ–≥–∏–æ–Ω–∞–º.
–ó–æ–Ω–¥—ã –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –î–ù–ö –≤ —Ä–∞—Å—Ç–≤–æ—Ä–µ (in-solution) –∏–ª–∏ –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ (on-array).
–ö–æ–º–ø–ª–µ–∫—Å—ã –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Å—Ç—Ä–µ–ø—Ç–∞–≤–∏–¥–∏–Ω-–º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–∞–≥–Ω–∏—Ç–Ω—ã—Ö —à–∞—Ä–∏–∫–æ–≤.
–ü—Ä–∏–º–µ—Ä: Agilent SureSelect, IDT xGen.
#### –ê–º–ø–ª–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–µ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ:
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–∏–º–µ—Ä–∞–∑–Ω—É—é —Ü–µ–ø–Ω—É—é —Ä–µ–∞–∫—Ü–∏—é (–ü–¶–†) —Å –ø–∞—Ä–∞–º–∏ –ø—Ä–∞–π–º–µ—Ä–æ–≤, –æ—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–º–∏ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ —É—á–∞—Å—Ç–∫–∏.
–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –ø–∞–Ω–µ–ª–µ–π, –Ω–æ –º–µ–Ω–µ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º.
CRISPR/Cas-–∑–∞–≤–∏—Å–∏–º–æ–µ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ:
–û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π —Ä–∞–∑—Ä–µ–∑–∫–µ –≤–Ω–µ—Ü–µ–ª–µ–≤—ã—Ö —É—á–∞—Å—Ç–∫–æ–≤, –æ—Å—Ç–∞–≤–ª—è—è –Ω—É–∂–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã.
–ú–µ–Ω–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–æ, –Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –¥–ª–∏–Ω–Ω—ã–º–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞–º–∏ –î–ù–ö.

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –¥–∏–∑–∞–π–Ω–∞:
–î–∏–∑–∞–π–Ω –∑–æ–Ω–¥–æ–≤ ‚Äî –∫–ª—é—á–µ–≤–∞—è —á–∞—Å—Ç—å –≥–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –æ–±–æ–≥–∞—â–µ–Ω–∏—è. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å–Ω–∏–∂–µ–Ω–∏—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø–æ–∫—Ä—ã—Ç–∏—è.
–û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
–í—ã–±–æ—Ä —Ü–µ–ª–µ–≤—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤:
–ì–µ–Ω–æ–º–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏—Ö —É—á–∞—Å—Ç–∫–æ–≤ (—ç–∫–∑–æ–Ω—ã, UTR, —Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏).
–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (RefSeq, Ensembl).

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∑–æ–Ω–¥–æ–≤:
–ó–æ–Ω–¥—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –∫–æ—Ä–æ—Ç–∫–∏–µ –æ–ª–∏–≥–æ–Ω—É–∫–ª–µ–æ—Ç–∏–¥—ã (–æ–±—ã—á–Ω–æ 80‚Äì120 –Ω—É–∫–ª–µ–æ—Ç–∏–¥–æ–≤).
–ö–∞–∂–¥—ã–π –∑–æ–Ω–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫–æ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ä–µ–Ω —Ü–µ–ª–µ–≤–æ–º—É —É—á–∞—Å—Ç–∫—É.
–ó–æ–Ω–¥—ã –º–æ–≥—É—Ç –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å—Å—è –¥–ª—è –ø–ª–æ—Ç–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è.
–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ñ–∏–∑–∏–∫–æ-—Ö–∏–º–∏—á–µ—Å–∫–∏–º —Å–≤–æ–π—Å—Ç–≤–∞–º:
–î–ª–∏–Ω–∞: –æ–±—ã—á–Ω–æ 120 –Ω—Ç ‚Äî –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—É—é —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç—å.
–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–ª–∞–≤–ª–µ–Ω–∏—è (Tm): –∑–æ–Ω–¥ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å Tm –≤ —É–∑–∫–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 65‚Äì72‚ÄØ¬∞C) –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –≥–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏–∏.
GC-—Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ: —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–æ–µ –∏–ª–∏ –≤—ã—Å–æ–∫–æ–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏–ª–∏ –Ω–µ—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç–∏.
ŒîG –≤—Ç–æ—Ä–∏—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã: –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã—Ö —à–ø–∏–ª–µ–∫ –∏ –¥–∏–º–µ—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ŒîG > ‚Äì9.0 –∫–∫–∞–ª/–º–æ–ª—å —Å—á–∏—Ç–∞–µ—Ç—Å—è –¥–æ–ø—É—Å—Ç–∏–º—ã–º).
–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å: –∑–æ–Ω–¥ –Ω–µ –¥–æ–ª–∂–µ–Ω –≥–∏–±—Ä–∏–¥–∏–∑–æ–≤–∞—Ç—å—Å—è –∫ –≤–Ω–µ—Ü–µ–ª–µ–≤—ã–º —É—á–∞—Å—Ç–∫–∞–º ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, BLAST).
–°–∏–º—É–ª—è—Ü–∏—è –≥–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏–∏:
–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –±–∏–æ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, RNAfold, Primer3, NUPACK), —á—Ç–æ–±—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –≤—Ç–æ—Ä–∏—á–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –≥–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏—é.
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –ø–æ—Ä–æ–≥–∞–º.
–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
–û—Ç–æ–±—Ä–∞–Ω–Ω—ã–µ –∑–æ–Ω–¥—ã —Å–∏–Ω—Ç–µ–∑–∏—Ä—É—é—Ç—Å—è –∏ —Ç–µ—Å—Ç–∏—Ä—É—é—Ç—Å—è in vitro –∏–ª–∏ in silico (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ö–≤–∞—Ç–∞ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏).


# –ö–æ–Ω–≤–µ–µ—Ä –¥–ª—è –¥–∏–∑–∞–π–Ω–∞ –∑–æ–Ω–¥–æ–≤ BRCA1/2

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω–≤–µ–µ—Ä —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–ª–∏–≥–æ–Ω—É–∫–ª–µ–æ—Ç–∏–¥–Ω—ã—Ö –∑–æ–Ω–¥–æ–≤, –Ω–∞—Ü–µ–ª–µ–Ω–Ω—ã—Ö –Ω–∞ –≥–µ–Ω—ã BRCA1 –∏ BRCA2 –≤ –≥–µ–Ω–æ–º–µ —á–µ–ª–æ–≤–µ–∫–∞ (—Ä–µ—Ñ–µ—Ä–µ–Ω—Å: hs37d5). –ö–æ–Ω–≤–µ–µ—Ä –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ñ–∞–π–ª—ã –≥–µ–Ω–æ–º–æ–≤ –∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π,
- –∏–∑–≤–ª–µ–∫–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —ç–∫–∑–æ–Ω–æ–≤,
- –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏–µ—Å—è –∑–æ–Ω–¥—ã,
- —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∑–æ–Ω–¥—ã –ø–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é GC, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –ø–ª–∞–≤–ª–µ–Ω–∏—è (Tm), –ø–æ–≤—Ç–æ—Ä–∞–º –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–æ–π –≤—Ç–æ—Ä–∏—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ (ŒîG).

–ü–æ–ª—É—á–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –∑–æ–Ω–¥–æ–≤ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≥–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –æ–±–æ–≥–∞—â–µ–Ω–∏—è –º–∏—à–µ–Ω–µ–π –≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö NGS.

---

## üß¨ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –≥–µ–Ω–æ–º–∞ (FASTA) –∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π (GTF).
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —ç–∫–∑–æ–Ω–æ–≤ BRCA1/2 –≤ —Ñ–æ—Ä–º–∞—Ç–µ BED.
- –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π —Å –ø–æ–º–æ—â—å—é `bedtools getfasta`.
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏—Ö—Å—è –ø—Ä–æ–± (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 120 –Ω—Ç, —à–∞–≥ ‚â§ 60 –Ω—Ç).
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ:
  - –°–æ–¥–µ—Ä–∂–∞–Ω–∏—é GC (–Ω–∞–ø—Ä–∏–º–µ—Ä, 40‚Äì60%).
  - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –ø–ª–∞–≤–ª–µ–Ω–∏—è (Tm).
  - –ü–æ–≤—Ç–æ—Ä–∞–º (–≥–æ–º–æ–ø–æ–ª–∏–º–µ—Ä—ã, –¥–∏-/—Ç—Ä–∏–Ω—É–∫–ª–µ–æ—Ç–∏–¥–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, –ø–∞–ª–∏–Ω–¥—Ä–æ–º—ã).
  - –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–æ–π –≤—Ç–æ—Ä–∏—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ (ŒîG —á–µ—Ä–µ–∑ RNAfold).
- –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Python-—Å–∫—Ä–∏–ø—Ç (`main.py`) —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.
- –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –±—É–¥—É—â–µ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ, –æ—Ç—á–µ—Ç—ã).

---

## üì¶ Requirements


## üß¨ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –≥–µ–Ω–æ–º–∞ (FASTA) –∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π (GTF).
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —ç–∫–∑–æ–Ω–æ–≤ BRCA1/2 –≤ —Ñ–æ—Ä–º–∞—Ç–µ BED.
- –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π —Å –ø–æ–º–æ—â—å—é `bedtools getfasta`.
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏—Ö—Å—è –ø—Ä–æ–± (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 120 –Ω—Ç, —à–∞–≥ ‚â§ 60 –Ω—Ç).
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ:
  - –°–æ–¥–µ—Ä–∂–∞–Ω–∏—é GC (–Ω–∞–ø—Ä–∏–º–µ—Ä, 40‚Äì60%).
  - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –ø–ª–∞–≤–ª–µ–Ω–∏—è (Tm).
  - –ü–æ–≤—Ç–æ—Ä–∞–º (–≥–æ–º–æ–ø–æ–ª–∏–º–µ—Ä—ã, –¥–∏-/—Ç—Ä–∏–Ω—É–∫–ª–µ–æ—Ç–∏–¥–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, –ø–∞–ª–∏–Ω–¥—Ä–æ–º—ã).
  - –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–æ–π –≤—Ç–æ—Ä–∏—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ (ŒîG —á–µ—Ä–µ–∑ RNAfold).
- –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Python-—Å–∫—Ä–∏–ø—Ç (`main.py`) —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.
- –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –±—É–¥—É—â–µ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ, –æ—Ç—á–µ—Ç—ã).

---

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### üîπ –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python ‚â• 3.8.
- [`bedtools`](https://bedtools.readthedocs.io/) ‚â• 2.30 ‚Äî –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è FASTA.
- [`RNAfold`](https://www.tbi.univie.ac.at/RNA/) ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –≤—Ç–æ—Ä–∏—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ (--structure-filter).

> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ bedtools:
> ```bash
> sudo apt install bedtools        # Debian/Ubuntu
> brew install bedtools            # macOS
> conda install -c bioconda bedtools
> ```

> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ RNAfold (ViennaRNA):
> ```bash
> sudo apt install vienna-rna      # Debian/Ubuntu
> brew install viennarna           # macOS
> conda install -c bioconda viennarna
> ````

### üîπ Python-–ø–∞–∫–µ—Ç—ã
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ pip:

```bash
pip install -r requirements.txt

## ‚ö° Quick Start (command-line)

Run the full pipeline using the provided `main.py` script:

```bash
python main.py
```

#### Optional arguments:

- `--force-download` ‚Äì re-download reference data
- `--force-prep` ‚Äì regenerate exon BED and FASTA files
- `--input-fasta path` ‚Äì override exon input FASTA file (default: `data/brca_exons.fa`)
- `--output-fasta path` ‚Äì override probe output FASTA file (default: `data/brca_probes.fa`)
- `--probe-length N` ‚Äì set probe length (default: 120)
- `--max-step N` ‚Äì set max step between probes (default: 60)

#### Filtering options:
- `--gc-min` <float> ‚Äì minimum GC content (%), default: 40.0
- `--gc-max` <float> ‚Äì maximum GC content (%), default: 60.0
- `--tm-min` <float> ‚Äì minimum Tm (¬∞C), default: 65.0
- `--tm-max` <float> ‚Äì maximum Tm (¬∞C), default: 72.0
- `--no-repeats` ‚Äì exclude probes with homopolymers or repeat patterns
- `--structure-filter` ‚Äì enable RNAfold-based secondary structure filtering
- `--dg-threshold` <float> ‚Äì minimum acceptable ŒîG (kcal/mol), default: -9.0

#### Repeat filter parameters:
- `--homopolymer-threshold <int>` ‚Äì min. length of homopolymers (default: 6)
- `--tandem-min-repeats <int>` ‚Äì min. number of motif repeats (default: 3)
- `--disable-palindromes` ‚Äì disable filtering of palindromic sequences
- `--disable-low-complexity` ‚Äì disable low-complexity region filtering
- `--palindrome-min-length <int>` ‚Äì min. length for palindromes (default: 6)

### üß™ –ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞

# üöÄ –ó–∞–ø—É—Å–∫ –ø–∞–π–ø–ª–∞–π–Ω–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
python main.py

# üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–æ–Ω–¥–æ–≤
python main.py --force-download --force-prep

# üß¨ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–ª–∏–Ω—ã –∏ —à–∞–≥–∞ –∑–æ–Ω–¥–æ–≤
python main.py --probe-length 100 --max-step 40

# üìÅ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –¥—Ä—É–≥—É—é –ø–∞–ø–∫—É
python main.py --output-fasta results/probes_v1.fa

# üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª —Å –º–µ—Ç–∫–æ–π –≤—Ä–µ–º–µ–Ω–∏
python main.py --output-fasta results/probes_$(date +%Y%m%d).fa

# üß¨ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–≤–æ–µ–≥–æ FASTA —Ñ–∞–π–ª–∞ —ç–∫–∑–æ–Ω–æ–≤
python main.py --input-fasta data/my_exons.fa \
               --output-fasta results/my_probes.fa

# üõ† –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–æ–Ω–¥–æ–≤ –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
python main.py --force-prep

# üå° –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –ø–ª–∞–≤–ª–µ–Ω–∏—è
python main.py --tm-min 64 --tm-max 70

# üö´ –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–± —Å –ø–æ–≤—Ç–æ—Ä–∞–º–∏
python main.py --no-repeats

# üß± –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–≤—Ç–æ—Ä–æ–≤
python main.py --homopolymer-threshold 5 --tandem-min-repeats 4

# üö´ –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø–æ–≤—Ç–æ—Ä–æ–≤
python main.py --disable-palindromes --disable-low-complexity

# üíß –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ GC –∏ –≤—Ç–æ—Ä–∏—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
python main.py --gc-min 42 --gc-max 58 --structure-filter --dg-threshold -8.0

# üî¨ –ü–æ–ª–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è: GC, Tm, –ø–æ–≤—Ç–æ—Ä—ã, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
python main.py \\
  --force-download --force-prep \\
  --probe-length 120 --max-step 60 \\
  --gc-min 40 --gc-max 60 \\
  --tm-min 65 --tm-max 72 \\
  --no-repeats --structure-filter --dg-threshold -9.0
  --homopolymer-threshold 6 --tandem-min-repeats 3 \
  --disable-palindromes --disable-low-complexity \
  --palindrome-min-length 6

### üß¨ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–∑ Python (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)

from reference_preparer import ReferencePreparer
from probe_generator import ProbeGenerator
from probe_filter_pipeline import ProbeFilterPipeline

### üì• –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

rp = ReferencePreparer(
    genome_url="ftp://...",                          # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —Å–≤–æ–∏ URL
    annotation_url="ftp://...",
    output_dir="data"                                # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: "data"
)
rp.prepare_all(force_download=True, force_preparing=True)  # –ó–∞–≥—Ä—É–∑–∫–∞, –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ, –æ–±—Ä–∞–±–æ—Ç–∫–∞. –û–±–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é False.

### üß¨ Step 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏—Ö—Å—è –∑–æ–Ω–¥–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ BRCA1/2 —ç–∫–∑–æ–Ω–∞—Ö
```python
pg = ProbeGenerator(
    input_fasta="data/brca_exons.fa",
    output_fasta="data/brca_probes.raw.fa",
    probe_length=120,
    max_step=60
)
pg.generate_all() 
```

### üßπ Step 3: Apply filters to probes
Each filtering step is available as a separate method and returns a filtered list of SeqRecord objects:
```python
pf = ProbeFilterPipeline(
    input_fasta="data/brca_probes.raw.fa",
    output_fasta="data/brca_probes.filtered.fa",
    gc_min=40,
    gc_max=60,
    tm_min=65,
    tm_max=72,
    allow_repeats=False,
    structure_filter=True,
    dg_threshold=-9.0
    homopolymer_threshold=6,
    tandem_min_repeats=3,
    enable_palindromes=False,
    enable_low_complexity=False,
    palindrome_min_length=6
)
pf.apply_all()
```

### üõ† Optional: Use filters independently
```python
from Bio import SeqIO

probes = list(SeqIO.parse("data/brca_probes.raw.fa", "fasta"))

filtered_gc = pf.filter_by_gc(probes)
filtered_tm = pf.filter_by_tm(filtered_gc)
filtered_final = pf.filter_by_repeats(filtered_tm)
# Optional: structure filtering (requires RNAfold)
filtered_final = pf.filter_by_structure(filtered_rep)

SeqIO.write(filtered_final, "data/brca_probes.manual.fa", "fasta")
```
This is useful if you want to inspect intermediate results or apply filters interactively in notebooks.

### üßæ Available Filters

| Method                      | Description                                                                 |
|-----------------------------|-----------------------------------------------------------------------------|
| `filter_by_gc(probes)`      | Keep probes with GC content within `gc_min`‚Äì`gc_max` (%)                   |
| `filter_by_tm(probes)`      | Keep probes with melting temperature within `tm_min`‚Äì`tm_max` (¬∞C)         |
| `filter_by_repeats(probes)` | Remove probes with homopolymers, tandem repeats, palindromes, low-complexity |
| `filter_by_structure(probes)` | Remove probes with strong secondary structure (ŒîG < `dg_threshold`, via RNAfold) |

---

## üóÇ File Structure

```
.
‚îú‚îÄ‚îÄ data/                         # All intermediate and output files
‚îÇ   ‚îú‚îÄ‚îÄ hs37d5.fa                 # Reference genome (unzipped)
‚îÇ   ‚îú‚îÄ‚îÄ gencode.v19.annotation.gtf  # Gene annotation (unzipped)
‚îÇ   ‚îú‚îÄ‚îÄ brca_exons.bed            # BRCA1/2 exon coordinates
‚îÇ   ‚îú‚îÄ‚îÄ brca_exons.fa             # Extracted exon sequences
‚îÇ   ‚îú‚îÄ‚îÄ brca_probes.raw.fa        # Raw unfiltered probes
‚îÇ   ‚îú‚îÄ‚îÄ brca_probes.fa            # Final filtered probes
‚îÇ   ‚îî‚îÄ‚îÄ ...                       # Future: alignments, reports
‚îú‚îÄ‚îÄ reference_preparer.py         # Class for downloading and preprocessing reference data
‚îú‚îÄ‚îÄ probe_generator.py            # Class for generating overlapping probes
‚îú‚îÄ‚îÄ probe_filter_pipeline.py      # Class for filtering probes (GC, Tm, repeats, ŒîG)
‚îú‚îÄ‚îÄ main.py                       # Command-line entry point
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ test_reference_preparer.py
‚îú‚îÄ‚îÄ test_probe_generator.py
‚îú‚îÄ‚îÄ test_probe_filter_pipeline.py
‚îú‚îÄ‚îÄ test_structure_filter.py
```

---

## üìå To Do

- Add summary report (number of probes filtered at each step)
- Add support for multi-threaded structure filtering
- Add BLAST/BWA alignment step for specificity checking
- Visualize probe tiling across exons
- Add CLI output in JSON or TSV (optional metadata per probe)
- Add Jupyter Notebook wrapper for exploratory use

---

## üìñ License

MIT License. See `LICENSE` file.

---

## ‚öñÔ∏è Bash Shell Wrapper (Optional)

For convenience, you may use a simple shell script:

```bash
#!/bin/bash

# Run full pipeline with default parameters
echo "[INFO] Starting BRCA1/2 pipeline"
python main.py \\
    --force-download --force-prep \\
    --probe-length 120 --max-step 60 \\
    --gc-min 40 --gc-max 60 \\
    --tm-min 65 --tm-max 72 \\
    --no-repeats --structure-filter --dg-threshold -9.0
  --homopolymer-threshold 6 --tandem-min-repeats 3 \
  --disable-palindromes --disable-low-complexity \
  --palindrome-min-length 6
```

Save this to `run_pipeline.sh`, then run:

```bash
chmod +x run_pipeline.sh
./run_pipeline.sh
```

---


## üßæ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ä—É—á–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

```bash
# BRCA1/2 Probe Design Pipeline

# –°–∫–∞—á–∏–≤–∞–µ–º –∞–Ω–Ω–æ—Ç–∞—Ü–∏—é –≥–µ–Ω–æ–º–∞
wget ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_19/gencode.v19.annotation.gtf.gz
gunzip gencode.v19.annotation.gtf.gz

# –ù–∞—Ö–æ–¥–∏–º —Å—Ç—Ä–æ–∫–∏ –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ BRCA1 –∏ BRCA2
grep -E 'BRCA1|BRCA2' gencode.v19.annotation.gtf | grep 'exon' > brca_exons.gtf

# –î–æ—Å—Ç–∞–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
awk 'BEGIN{OFS="\t"} {match($0, /gene_name "([^"]+)"/, a); print $1, $4 - 1, $5, a[1]}' brca_exons.gtf > brca_exons.bed

# –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏ –∏ —Å–æ—Ä—Ç–∏—Ä—É–µ–º
sort -k1,1 -k2,2n brca_exons.bed | uniq > brca_exons.sorted.bed

# –°–∫–∞—á–∏–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≥–µ–Ω–æ–º–∞
wget https://ilmn-dragen-giab-samples.s3.amazonaws.com/FASTA/hs37d5.fa

# –ò–Ω–¥–µ–∫—Å–∏—Ä—É–µ–º –≥–µ–Ω–æ–º
bwa index hs37d5.fa

# –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —ç–∫–∑–æ–Ω–æ–≤
bedtools getfasta -fi hs37d5.fa -bed brca_exons.bed -fo brca_exons.fa -name

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–æ–Ω–¥–æ–≤ –ø–æ —ç–∫–∑–æ–Ω–∞–º (120 nt —Å —à–∞–≥–æ–º ‚â§ 60)
# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ GC 40‚Äì60%
# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ 65‚Äì72¬∞C
# –£–¥–∞–ª–µ–Ω–∏–µ –∑–æ–Ω–¥–æ–≤ —Å –ø–æ–≤—Ç–æ—Ä–∞–º–∏ (–≥–æ–º–æ–ø–æ–ª–∏–º–µ—Ä–Ω—ã–µ, —Ç–∞–Ω–¥–µ–º–Ω—ã–µ, –Ω–∏–∑–∫–æ—Å–ª–æ–∂–Ω—ã–µ, –ø–∞–ª–ª–∏–Ω–¥—Ä–æ–º—ã)
# –£–¥–∞–ª–µ–Ω–∏–µ –∑–æ–Ω–¥–æ–≤ —Å–æ –≤—Ç–æ—Ä–∏—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

# –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –Ω–∞ –≥–µ–Ω–æ–º
bwa mem hs37d5.fa probes_final.fa > probes_aligned.sam

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ BAM, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è
samtools view -Sb probes_aligned.sam > probes_aligned.bam
samtools sort probes_aligned.bam -o probes_aligned.sorted.bam
samtools index probes_aligned.sorted.bam

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ—Å—Ç–∏ (1 –∑–æ–Ω–¥ = 1 —ç–∫–∑–æ–Ω)
samtools view probes_aligned.sorted.bam | cut -f1 | sort | uniq -c | awk '$1 == 1'
```
